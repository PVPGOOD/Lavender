package io.justme.lavender.module.impl.blatant.exploit.disabler.impl;

import io.justme.lavender.La;
import io.justme.lavender.events.game.EventTick;
import io.justme.lavender.events.game.EventWorldReload;
import io.justme.lavender.events.network.EventPacket;
import io.justme.lavender.events.player.EventMotionUpdate;
import io.justme.lavender.events.render.Event2DRender;
import io.justme.lavender.module.impl.blatant.exploit.disabler.AbstractDisabler;
import io.justme.lavender.utility.math.TimerUtility;
import lombok.Getter;
import net.minecraft.client.Minecraft;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C0DPacketCloseWindow;
import net.minecraft.network.play.client.C0EPacketClickWindow;
import net.minecraft.network.play.client.C16PacketClientStatus;

import java.util.ArrayList;

/**
 * @author JustMe.
 * @since 2024/5/2
 **/
@Getter
public class WatchdogDisabler extends AbstractDisabler {

    private final TimerUtility timerUtility = new TimerUtility();
    private final ArrayList<Packet<?>> minecraftPackets = new ArrayList<>();
    private final ArrayList<Packet<?>> laPackets = new ArrayList<>();


    public WatchdogDisabler() {
        super("Watchdog");
    }

    @Override
    public void onEnable() {

    }

    @Override
    public void onDisable() {

    }

    private boolean closingInventory;
    private boolean hasInventoryOpen;

    private boolean pushing;
    private boolean neededC16Packet;
    @Override
    public void onPacket(EventPacket eventPacket) {
        if(mc.thePlayer == null || mc.isSingleplayer()) return;

        var packet = eventPacket.getPacket();

        if (packet instanceof C16PacketClientStatus) {
            La.getINSTANCE().print("打开");
        }

        if (packet instanceof C0EPacketClickWindow) {
            La.getINSTANCE().print("点击");
        }

        if (packet instanceof C0DPacketCloseWindow) {
            La.getINSTANCE().print("关闭");
        }
    }

    @Override
    public void on2D(Event2DRender event) {
        La.getINSTANCE().getFontManager().getPingFang_Heavy14().drawString("closingInventory: " + closingInventory,100,100,-1);
    }

    @Override
    public void onMotionUpdate(EventMotionUpdate event) {

    }

    @Override
    public void onWorldReload(EventWorldReload event) {

    }

    @Override
    public void onTick(EventTick event) {

    }

    @Override
    public void onInvokePacket(Packet<?> packet) {
        Minecraft.getMinecraft().getNetHandler().getNetworkManager().sendFinalPacket(packet);
    }
}
